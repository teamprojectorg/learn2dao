{"ast":null,"code":"import moment from 'moment';\nimport axios from 'axios';\nimport { CONFIG } from '../../config.js';\nconst chain_id = `1`;\nconst address = `0x4d224452801ACEd8B2F0aebE155379bb5D594381`;\nconst bitDAO_address = `0x1A4b46696b2bB4794Eb3D4c26f1c55F9170fa4C5`;\nexport default async function getTokenHolders(chain_id, address) {\n  const days_interval = 30;\n  let from = moment().subtract(days_interval, 'days').format('YYYY-MM-DD');\n  const currentDay = moment().format('YYYY-MM-DD');\n\n  // Steps to get tokenholders in the past 7 days \n  // 1. Get block heights  start_date and end_date 2022-10-01 and 2022-10-31\n  // 2. Take the tokenholders of the start_date block height and of the end_date blockholder\n  // 3 .plot the datas \n  let api_call_tokenholder = `https://api.covalenthq.com/v1/${chain_id}/tokens/${address}/token_holders_changes/?quote-currency=USD&format=JSON&starting-block=1&ending-block=100&key=ckey_af1d8bda66e340bd835f1855487`;\n  let api_call_blockheights = `https://api.covalenthq.com/v1//block_v2/2021-01-01/2021-01-03/?key=ckey_af1d8bda66e340bd835f1855487`;\n  try {\n    const resp = await axios.get(api_call_tokenholder, {\n      auth: {\n        username: CONFIG.TEMPLATE.api_key\n      }\n    });\n    // Organize response data to insert into graph\n    let date_to_blockheight = resp.data.data.items.map(i => ({\n      x: i.opening_date,\n      y: i.floor_price_quote_7d\n    })).reverse();\n    let date_to_holders_same = resp.data.data.items.map(i => ({\n      x: i.opening_date,\n      y: i.floor_price_wei_7d / 10 ** 18\n    })).reverse();\n  } catch (error) {\n    console.log(\"fail to fetch token holders\");\n  }\n}","map":{"version":3,"names":["moment","axios","CONFIG","chain_id","address","bitDAO_address","getTokenHolders","days_interval","from","subtract","format","currentDay","api_call_tokenholder","api_call_blockheights","resp","get","auth","username","TEMPLATE","api_key","date_to_blockheight","data","items","map","i","x","opening_date","y","floor_price_quote_7d","reverse","date_to_holders_same","floor_price_wei_7d","error","console","log"],"sources":["/Users/yuchenpeng/dao_terminal_v0/src/api/v1/getTokenHolders.js"],"sourcesContent":["\nimport moment from 'moment';\nimport axios from 'axios';\nimport {CONFIG} from '../../config.js'\n\nconst chain_id = `1`\nconst address = `0x4d224452801ACEd8B2F0aebE155379bb5D594381`\nconst bitDAO_address = `0x1A4b46696b2bB4794Eb3D4c26f1c55F9170fa4C5`\n\n\n export default async function getTokenHolders(chain_id, address){\n    const days_interval = 30; \n    let from = moment().subtract(days_interval, 'days').format('YYYY-MM-DD')\n \n    const currentDay =moment().format('YYYY-MM-DD')\n\n    // Steps to get tokenholders in the past 7 days \n    // 1. Get block heights  start_date and end_date 2022-10-01 and 2022-10-31\n    // 2. Take the tokenholders of the start_date block height and of the end_date blockholder\n    // 3 .plot the datas \n    let api_call_tokenholder = `https://api.covalenthq.com/v1/${chain_id}/tokens/${address}/token_holders_changes/?quote-currency=USD&format=JSON&starting-block=1&ending-block=100&key=ckey_af1d8bda66e340bd835f1855487`\n    let api_call_blockheights = \n        `https://api.covalenthq.com/v1//block_v2/2021-01-01/2021-01-03/?key=ckey_af1d8bda66e340bd835f1855487`\n\n    try{\n     const resp = await axios.get(api_call_tokenholder, {auth: {username: CONFIG.TEMPLATE.api_key}})\n     // Organize response data to insert into graph\n     let date_to_blockheight = resp.data.data.items.map(i => ({x:i.opening_date, y:i.floor_price_quote_7d})).reverse()\n    \n     let date_to_holders_same = resp.data.data.items.map(i => ({x:i.opening_date, y:i.floor_price_wei_7d / 10 ** 18})).reverse()\n \n    }catch(error){\n       console.log(\"fail to fetch token holders\")\n   }\n  }\n\n\n\n"],"mappings":"AACA,OAAOA,MAAM,MAAM,QAAQ;AAC3B,OAAOC,KAAK,MAAM,OAAO;AACzB,SAAQC,MAAM,QAAO,iBAAiB;AAEtC,MAAMC,QAAQ,GAAI,GAAE;AACpB,MAAMC,OAAO,GAAI,4CAA2C;AAC5D,MAAMC,cAAc,GAAI,4CAA2C;AAGlE,eAAe,eAAeC,eAAe,CAACH,QAAQ,EAAEC,OAAO,EAAC;EAC7D,MAAMG,aAAa,GAAG,EAAE;EACxB,IAAIC,IAAI,GAAGR,MAAM,EAAE,CAACS,QAAQ,CAACF,aAAa,EAAE,MAAM,CAAC,CAACG,MAAM,CAAC,YAAY,CAAC;EAExE,MAAMC,UAAU,GAAEX,MAAM,EAAE,CAACU,MAAM,CAAC,YAAY,CAAC;;EAE/C;EACA;EACA;EACA;EACA,IAAIE,oBAAoB,GAAI,iCAAgCT,QAAS,WAAUC,OAAQ,+HAA8H;EACrN,IAAIS,qBAAqB,GACpB,qGAAoG;EAEzG,IAAG;IACF,MAAMC,IAAI,GAAG,MAAMb,KAAK,CAACc,GAAG,CAACH,oBAAoB,EAAE;MAACI,IAAI,EAAE;QAACC,QAAQ,EAAEf,MAAM,CAACgB,QAAQ,CAACC;MAAO;IAAC,CAAC,CAAC;IAC/F;IACA,IAAIC,mBAAmB,GAAGN,IAAI,CAACO,IAAI,CAACA,IAAI,CAACC,KAAK,CAACC,GAAG,CAACC,CAAC,KAAK;MAACC,CAAC,EAACD,CAAC,CAACE,YAAY;MAAEC,CAAC,EAACH,CAAC,CAACI;IAAoB,CAAC,CAAC,CAAC,CAACC,OAAO,EAAE;IAEjH,IAAIC,oBAAoB,GAAGhB,IAAI,CAACO,IAAI,CAACA,IAAI,CAACC,KAAK,CAACC,GAAG,CAACC,CAAC,KAAK;MAACC,CAAC,EAACD,CAAC,CAACE,YAAY;MAAEC,CAAC,EAACH,CAAC,CAACO,kBAAkB,GAAG,EAAE,IAAI;IAAE,CAAC,CAAC,CAAC,CAACF,OAAO,EAAE;EAE5H,CAAC,QAAMG,KAAK,EAAC;IACVC,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;EAC9C;AACD"},"metadata":{},"sourceType":"module"}